<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="msvalidate.01" content="3BB4D18369B9C21326AF7A99FCCC5A09"><meta property="fb:app_id" content="537395183072744"><title>Apprentice Soft's devlog - libGDX Jam - Powered by RoboVM &amp; Robotality community - itch.io</title><meta value="IjUzelV0UnA2RThzUFdRMCBVUiBCVVRUIE41Y1lRNDhONGtPUzVYNyI=.vuSBVT/fVMLsj5VwP667aGD+yHk=" name="csrf_token"><meta content="itch.io" property="og:site_name"><meta content="4503599627724030" property="twitter:account_id"><link rel="canonical" href="https://itch.io/jam/libgdxjam/topic/12039/apprentice-softs-devlog"><link rel="manifest" href="https://itch.io/static/manifest.json"><meta content="Hey, So finally, I create my devlog. I spent a part of the evening brainstorming, I read the different develogs and saw some already interesting ideas of RTS and RPG. On my side, I'll go on a much sim" property="og:description"><meta content="Hey, So finally, I create my devlog. I spent a part of the evening brainstorming, I read the different develogs and saw some already interesting ideas of RTS and RPG. On my side, I'll go on a much sim" name="description"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="#FA5C5C" name="theme-color"><link rel="stylesheet" href="blog_fichiers/css.css" type="text/css">      <script type="text/javascript" async="" src="blog_fichiers/s.js"></script><script type="text/javascript" async="" src="blog_fichiers/ecommerce.js"></script><script async="" src="blog_fichiers/analytics.js"></script><script type="text/javascript">
        var _sift = window._sift = window._sift || [];
        _sift.push(['_setAccount', "82f227d0c5"]);
        _sift.push(['_setUserId', ""]);
        _sift.push(['_setSessionId', "c7925a3df3ce01a47cadd031fe1cdee5"]);
        _sift.push(['_trackPageview']);

        (function(){function ls(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="https://cdn.siftscience.com/s.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(e,s)}if(window.attachEvent){window.attachEvent("onload",ls)}else{window.addEventListener("load",ls,false)}})();
      </script>
  <link rel="stylesheet" href="blog_fichiers/main.css"><script type="text/javascript">if (!window.location.hostname.match(/localhost/)) {        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga("create", {"cookieDomain":"auto","trackingId":"UA-136625-6"})
        ga("send", "pageview");
        ga("require", "ecommerce");
      }</script><script src="blog_fichiers/lib.js" type="text/javascript"></script><script src="blog_fichiers/bundle.js" type="text/javascript"></script><script src="blog_fichiers/jam.js" type="text/javascript"></script><script src="blog_fichiers/intern.js" type="text/javascript"></script><script type="text/javascript">I.bucket_url = 'http://itchio.commondatastorage.googleapis.com/';I.current_user = null;</script></head><body data-page_name="jam.community_topic" data-host="itch.io" class="main_layout responsive"><div id="header_widget_5595" class="header_widget"><div class="primary_header"><h1 title="itch.io - indie game hosting marketplace" class="title"><a href="https://itch.io/" title="itch.io - indie game hosting marketplace" data-label="logo" class="header_logo"></a></h1><div class="header_buttons"><a href="https://itch.io/games" data-label="browse" class="header_button browse_btn">Browse games</a><a href="https://itch.io/jams" data-label="jams" class="header_button jams_btn">Game jams</a><a href="https://itch.io/developers" data-label="developers" class="header_button developers_btn"><span class="icon icon-upload"></span>Upload a game</a><a href="https://itch.io/devlogs" data-label="devlogs" class="header_button devlogs_btn">Devlogs</a></div><form action="/search" class="game_search"><input required="required" class="search_input" name="q" placeholder="Search for games or creators" type="text"><button class="submit_btn">Search</button></form><div class="user_panel_widget"><a href="https://itch.io/login" data-register_action="header" data-label="log_in" class="panel_button">Log in</a><a href="https://itch.io/register" data-register_action="header" data-label="register" class="panel_button register_button">Register</a></div></div><div class="header_dropdown"><a href="https://itch.io/games/store">ü§ë Indie game store</a><a href="https://itch.io/games/free">üôå Free games</a><a href="https://itch.io/games/fun">üòÇ Fun games</a><a href="https://itch.io/games/tag-horror">üò® Horror games</a><div class="divider"></div><a href="https://itch.io/tools">üë∑ Game development</a><a href="https://itch.io/game-assets">üé® Assets</a><a href="https://itch.io/comics">üìö Comics</a><div class="divider"></div><a href="https://itch.io/sales">üéâ Sales</a><a href="https://itch.io/bundles">üéÅ Bundles</a></div></div><script type="text/javascript">I.page_header = new I.Header('#header_widget_5595');</script><div class="jam_community_topic_page jam_community_page jam_page_base_page page_widget"><style type="text/css" id="jam_theme">
.jam_page_base_page a,
.jam_page_base_page .topic_row.unread_posts .topic_title > a
{
  color: #dd4a49;
}

.jam_page_base_page .stats_container a:hover .stat_value,
.jam_page_base_page .stats_container a:hover .stat_label
{
  color: #dd4a49;
}

.jam_page_base_page .jam_title_header a {
  color: inherit !important;
}

.jam_page_base_page .header_tabs .header_tab.active,
.jam_page_base_page .header_tabs .header_tab:hover
{
  border-color: #FA5C5C;
}


.jam_page_base_page .page_tabs .tab.active,
.jam_page_base_page .page_tabs .tab:hover
{
  color: #dd4a49;
  border-color: #FA5C5C;
}

.jam_page_base_page .button {
  background-color: #FA5C5C;
  color: #ffffff;
  text-shadow: 0 1px 0px #e54747;
  border-color: #e54747;
}

.jam_page_base_page .button.disabled {
  opacity: 0.5;
  filter: grayscale(100%);
}

.jam_page_base_page .button.outline {
  color: #dd4a49;
  text-shadow: none;
}

.jam_page_base_page .button.outline:hover {
  color: #dd4a49;
  border-color: #FA5C5C;
}
</style><div class="jam_header_widget"><div class="header_inner"><div class="header_columns"><div class="cover_column"><div style="background-image: url('https://img.itch.zone/aW1hZ2UyL2phbS8yMTM5LzIxMDAxNi5wbmc=/82x65%23/2QoWnY.png')" class="cover_image"></div></div><div class="title_colum"><h1 class="jam_title_header"><a href="https://itch.io/jam/libgdxjam">libGDX Jam - Powered by RoboVM &amp; Robotality</a></h1><div class="jam_host_header">Hosted by <a href="https://badlogic.itch.io/">badlogic</a></div></div><div class="stats_container"><div class="stat_box"><a href="https://itch.io/jam/libgdxjam/entries"><div class="stat_value">83</div><div class="stat_label">Entries</div></a></div><div class="stat_box"><div class="stat_value">1,684</div><div class="stat_label">Ratings</div></div></div></div><div class="header_tabs"><a href="https://itch.io/jam/libgdxjam" data-label="tab_view_jam" class="header_tab">Overview</a><a href="https://itch.io/jam/libgdxjam/feed" data-label="tab_view_jam_feed" class="header_tab">Submission feed</a><a href="https://itch.io/jam/libgdxjam/entries" data-label="tab_view_jam_entries" class="header_tab">Entries</a><a href="https://itch.io/jam/libgdxjam/screenshots" data-label="tab_view_jam_screenshots" class="header_tab">Screenshots</a><a href="https://itch.io/jam/libgdxjam/results" data-label="tab_jam_results" class="header_tab">Results</a><div class="tab_group"><a href="https://itch.io/jam/libgdxjam/community" data-label="tab_table: 0x41651c78" class="header_tab active">Community</a><span class="community_activity">163</span></div></div></div></div><div class="column_outer"><div class="content_frame"><div id="community_topic_posts_widget_54451" class="community_topic_posts_widget"><div data-topic_id="12039" class="community_topic_header_widget tabbed_header_widget" id="community_topic_header_widget_11521"><div class="stat_header_widget"><div class="text_container"><div class="topic_back"><a href="https://itch.io/jam/libgdxjam/community">‚Üê <span class="text">Return to topic list</span></a></div><h1>Apprentice Soft's devlog<span class="topic_flags">  </span></h1><div class="topic_meta"><span class="topic_date">A topic by <a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a> created <abbr title="19 December 2015 @ 06:42"><span class="icon icon-stopwatch"></span> Dec 19, 2015</abbr></span> <span class="views_count">Views: 334,486</span> <span class="posts_count">Replies: 46</span></div></div></div><div class="sub_header"><div class="topic_pager "><span class="page_label">Viewing posts <nobr><span>1</span> to <span>20</span> of 43</nobr></span> ¬∑ <a href="https://itch.io/jam/libgdxjam/topic/12039/apprentice-softs-devlog?after=20" class="page_link">Next page</a> ¬∑ <a href="https://itch.io/jam/libgdxjam/topic/12039/apprentice-softs-devlog?before=44" class="page_link">Last page</a></div></div></div><script type="text/javascript">new I.CommunityTopicHeader('#community_topic_header_widget_11521', {"moderation":{"urls":{"delete_topic":"\/topic\/:topic_id\/delete","lock_topic":"\/topic\/:topic_id\/lock","stick_topic":"\/topic\/:topic_id\/stick","archive_topic":"\/topic\/:topic_id\/archive"}}})</script><div class="padded"><div class="community_post_list_widget has_vote_column"><div id="first-post"></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6196}" id="post-6196" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-19 06:42:55" class="post_date"><a href="https://itch.io/jam/libgdxjam/topic/12039/apprentice-softs-devlog">2 years ago</a></span> <span class="edit_message">(Edited 3 times)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><p>Hey,</p><p>So
 finally, I create my devlog. I spent a part of the evening 
brainstorming, I read the different develogs and saw some already 
interesting ideas of RTS and RPG. On my side, I'll go on a much simpler 
and less ambitious project. I needed an idea that I can realize alone, 
with my limited coding skills and non-existent skills in drawing and 
designing sounds, haha.</p><p>So I came up with this idea of 
puzzle-platformer game in which you control a guy, in a jetpack equipped
 space suit that tries to escape his wrecked spaceship.</p><p><br></p><hr><h2>EDIT</h2><ul><li><a href="https://github.com/ApprenticeSoft/libGDX-Jam---Life-in-Space/" rel="nofollow noopener">Source code on GitHub</a></li><li><a href="http://itch.io/jam/libgdxjam/rate/51123">Download and rate the game</a></li></ul></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6199}" id="post-6199" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-19 06:57:23" class="post_date"><a href="https://itch.io/post/6199">2 years ago</a></span> <span class="edit_message">(Edited 2 times)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Plot</h1><p>- <i>Ground control</i> : Ground control to major Tom.</p><p>- <i>Major Tom</i> : hu ?</p><p>- <i>Ground control</i> : We've got bad news.</p><p>- <i>Major Tom</i> : hu ?</p><p>- <i>Ground control</i> : Well‚Ä¶ you know‚Ä¶ hum‚Ä¶ that intern I told you about last week ?</p><p>- <i>Major Tom</i> : hu ?</p><p>- <i>Ground control</i>
 : Yeah, that's him. Well, he fucked up. He was assigned to the asteroid
 detection while you cross the asteroid belt, and‚Ä¶ how to say ? He was 
doing a good job the 1st month, and I didn't watch him that much lately,
 and this little brat, while he was supposed to monitor the approaching 
asteroids, spent his time playing to Candy Crush on Facebook and‚Ä¶</p><p>- <i>Major Tom</i> : HE TOOK ADVANTAGE OF MY ABSENCE TO BEAT MY SCORE !?!?!?!?</p><p>- <i>Ground control</i>
 : No‚Ä¶ hum‚Ä¶ long story short : You are going right into a very dense 
region of the asteroid belt. And given your speed, there is no way you 
can avoid it. Actually you can reach this region at any moment.</p><p>- <i>Major Tom</i> : hu ?</p><p>- <i>Ground control </i>:
 Yeah, if you are lucky enough to don't hit a huge asteroid you'll still
 have to face a micrometeoroid rain that will shatter your spaceship.</p><p>- <i>Major Tom </i>: So‚Ä¶ what's the plan?</p><p>- <i>Ground control </i>: You'll have a painful death.</p><p>- <i>Major Tom </i>: hu?</p><p>- <i>Ground control </i>:
 One last thing: We just blew a 72 thousand billion dollars mission, and
 to amortize the costs we had this idea of making a movie about your 
story. We thought you had your word on this. We approached Ridley Scott,
 Christopher Nolan and Woody Allen to direct the movie, do you have any 
preferences?</p><p><b>MICROMETEOROID RAIN HITS THE SPACESHIP</b></p><p>- <i>Computer </i>: Warning! Warning ! Oxygen leak detected. Artificial gravity system damaged.</p><p>- <i>Major Tom </i>: Dammit! Where is my space suit?</p><p><br></p><hr> <h1>Concept</h1><p>The
 game will involve Box2D. The player will control Major Tom in his 
jetpack equipped space suit. The aim is to reach the safety spaceship. 
Each level will be a room of the main spaceship.</p><p>Here is an ugly concept screen :</p><p><img src="blog_fichiers/852934Concept.jpg"> <br></p><p><br></p><hr><h1>Gameplay</h1><ul><li>Control with WAD<ul><li>W : linear impulse with the jetpack</li><li>A and D : counter-clockwise and clockwise rotation</li></ul></li><li>No gravity</li><li>No air friction</li><li>Fuel limitation : The longer you press W the more you consume fuel. Use you jetpack wisely to make it to the room exit</li><li>Air limitation : You have to exit the room before you run out of air.</li></ul><p>Basically,
 if you use too much your jetpack to go fast, you'll end up without 
fuel, but if you go really slowly to save fuel, you won't have enough 
air. There might be air and fuel supply to pick up in hardest levels.</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6372}" id="post-6372" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-20 05:14:08" class="post_date"><a href="https://itch.io/post/6372">2 years ago</a></span> <span class="edit_message">(Edited 1 time)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><p>Time to write the devlog !</p><p>I've
 been thinking a lot about the form that my devlog would take. I asked 
myself why I wanted to join this jam. Two things came up : Having fun, 
and sharing experiences. Therefore, I decided to make a full tutorial, 
with code and everything. Starting from the very basic, and yet boring 
for anyone taking part to this jam : Installing and setting up a libGDX 
project. The jam is one month long, so I guess I can afford to spend 50%
 of the time I dedicate to this jam for the purpose of writing a decent 
tutorial devlog.</p><p>For the record :</p><p>- I am absolutely not a 
pro, thus, my code won't be clean, and I'll present the things the way I
 do them which is not necessarily the best way to do them.</p><p>- I 
work with Eclipse IDE, even though since summer 2015 Android Studio is 
the official IDE for Android, and everywhere you'll see that you must 
migrate to Android Studio as soon as possible. But I am lazy, and as 
long as my projects created with Eclipse work, I won't migrate. Thus my 
tutorials will only refer to Eclipse.<span></span></p><p><br></p><p>So here we go ! Let's start by the very beginning !</p><p>Those who already know libGDX may directly jump to the next post.</p><hr><h1>Setting up the libGDX project</h1><h2>Setting up the environment</h2><p>To use libGDX with Eclipse, you'll need to set your work environment up. For that you'll need to install</p><ul><li> <a href="http://www.eclipse.org/downloads/" rel="nofollow noopener">Eclipse</a></li><li><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" rel="nofollow noopener">Java Development Kit (JDK)</a>. Just take the latest version you find.</li><li><a href="http://developer.android.com/sdk/installing/index.html?pkg=tools" rel="nofollow noopener">Android SDK (The stand-alone version)</a></li><li>Android Development Tools (ADT)</li><li>Gradle</li></ul><p>To install ADT and Gradle, you can simply use the Eclipse Marketplace : Once you installed Eclipse, go in <em>Help</em> ---&gt; <em>Eclipse Marketplace</em>. In the marketplace, just do a research on ADT and Gradle.</p><p>Once you finished setting up your work environment, you can set up your project !</p><h2>Setting up the project</h2><p>Just go on the <a href="https://libgdx.badlogicgames.com/download.html" rel="nofollow noopener">libGDX download page</a> and install the latest version of libGDX and start it, you'll get this screen :</p><p><img src="blog_fichiers/950770libGDXsetup.png"> <br></p><p>On
 this screen you'll chose the name of your project, package, game class,
 the folder where you'll create your project, and the android SDK 
location. If you don't remember where you installed it, start Eclipse, 
go in <em>Window</em> ---&gt; <em>Preferences</em> ---&gt; <em>Android</em> and at the top of the Preferences window you'll find the SDK location link . Just copy and paste the link in the libGDX window.</p><p>Still
 in the libGDX window, you can choose which platform you want your game 
to run on, and you can install some extensions. I know for sure I'll 
need Box2d and Freetype, and I install Tools and Box2dlights "just in 
case". Finally you can generate the project.</p><h2>Importing the project</h2><p>Now that you created your libGDX project, you need to import it in Eclipse. For that, in Eclipse go in <em>File</em> ---&gt; <em>Import</em>.</p><p>You'll get this screen :</p><p><img src="blog_fichiers/397293Import1.png"> <br></p><p>Click on <em>Gradle Project</em> and <em>Next</em>, and you'll get this screen :</p><p><img src="blog_fichiers/817780Import2.png"> <br></p><p>On this screen browse to the location of your project and find the folder <em>core</em>. Then click on <em>Build Model</em>, check all the part of the project you want to import to Eclipse (android, desktop....) knowing that you absolutely need <em>core</em>, and also <em>desktop</em> as we'll run the game on desktop during all the coding.</p><p><br></p><p>And that's it ! Your libGDX is set up, and you are ready to develop your game !</p><h2>The default project</h2><p>If you open the <em>core</em> folder, you'll there is only one class, <em>MyGdxGame</em>. Soon, we'll create a lot of other class and packages to make a lot of cool stuff !</p><p><img src="blog_fichiers/691838MyGdxGame.png"> <br></p><p>To run this default project, right-click on the folder <em>desktop</em> and go to <em>Run</em><em> As</em> ---&gt; <em>Java Application</em> ---&gt; <em>DesktopLauncher</em>.</p><p>You'll get this screen displaying the Bad Logic logo :</p><p><img src="blog_fichiers/680160firstgamescreen.png"> <br></p><p><br></p><p><strong>This is it for the basic setup !</strong></p><p><strong>As from the next post we attack the real fun !</strong><strong> Game coding !</strong><br></p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6387}" id="post-6387" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-20 07:27:48" class="post_date"><a href="https://itch.io/post/6387">2 years ago</a></span> <span class="edit_message">(Edited 1 time)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Time to code !</h1><h2>Basic setup</h2><p>First of all, we'll modify the <em>DesktopLauncher.java</em>
 to choose a resolution and a name for the game window. As I still don't
 have a name for my project, I'll simply go with "Life in Space", and I 
chose a resolution of 960 * 640 for the development.</p><p>Here is my <strong>DesktopLauncher.java</strong><strong> </strong> :</p><pre>public class DesktopLauncher {
    public static void main (String[] arg) {
        LwjglApplicationConfiguration config = new LwjglApplicationConfiguration();
        config.title = "Life in Space";
        config.width = 960;
        config.height = 640;
        new LwjglApplication(new MyGdxGame(), config);
    }
}
</pre><p>Then I modify the MyGdxGame.java by extending Game.java, so I can use screens.</p><p>Here is the <strong>MyGdxGame.java </strong>:</p><pre>public class MyGdxGame extends Game implements ApplicationListener{
    public SpriteBatch batch;
    public AssetManager assets;
    
    @Override
    public void create () {
        batch = new SpriteBatch();
        assets = new AssetManager();
        
        this.setScreen(new GameScreen(this));
    }


    @Override
    public void render () {
        super.render();
    }
}
</pre><p>You can see that I created a <em>SpriteBatch</em>, that I'll use to draw all the graphics of the game, and an <em>AssetManager</em>, that will be useful later to load the assets, when I'll have assets. Then you can see that in the <i>create()</i> I call <em>this.setScreen(new GameScreen(this));</em>, thus the game display the game screen. Later I'll have more screens, like a <em>LoadingScreen</em> that I'll display when I load the assets, and a <em>MainMenuScreen</em>.</p><p>Important : In the <em>render()</em>, don't forget to do <em>super.render();</em> !</p><p>And here is what the freshly created GameScreen class look like.</p><p><strong>GameScreen.java</strong> :</p><pre>public class LoadingScreen implements Screen{
    final MyGdxGame game;
    
    public LoadingScreen(final MyGdxGame game){
        this.game = game;
    }

    @Override
    public void render(float delta) {
        // TODO Auto-generated method stub      
    }

}
</pre><p>Now let's run this project !</p><p><img src="blog_fichiers/2990312ndGameScreen.png"> <br></p><p>This class displays absolutely nothing for now !</p><p>What am I waiting to make this class displaying an amazing game ?</p><p>Well... it's not that simple. My project will involve physics, thus I'll use <a href="http://box2d.org/" rel="nofollow noopener">Box2D</a>, and to create the levels, I'll use <a href="http://www.mapeditor.org/" rel="nofollow noopener">Tiled</a>. Therefore, before having fun with creating level and game mechanics, I need to integrate Box2D and Tiled to the project.</p><h2>Integrating Box2D and Tiled to the project</h2><h3>Tiled</h3><p>Tiled
 is trully an amazing level editor. Not only you draw beautiful maps 
using your tileset, but you can also draw shapes, like rectangles, 
ellipses, polygones, lines that Box2D can convert into bodies to 
integrate in the game.</p><p>Here is an illustration of the logic :</p><p><img src="blog_fichiers/337504Gamelogic.png"> <br></p><p>So where do we start ?</p><p>I'll
 go in the order of the logic exposed above, thus I'll start by drawing a
 quick map with Tiled, and then we'll see code. A LOT.</p><p>Here is the map, called <strong>Level 1</strong> :</p><p><img src="blog_fichiers/971732Level1Map.png"></p><p>In this screenshot, in the right column, at the top, I created 3 layers : Objects, Spawn and Tile Layer 1.</p><ul><li>Objects
 : This is an object layer. In object layers you can draw polygons and 
put images. In this layer I draw the polygons that will be converted to 
bodies by Box2D.</li><li>Spawn : This is also an object layer. In this 
layer I put an image from my tileset, that will represent the hero spawn
 points. For now my tileset only contains this red dot as I didn't draw 
anything yet. If I click on the red dot, I can give it a name (right 
column top) I call it Tom. That'll be important later.</li></ul><div>We are done with Tiled for now. Now let's create bodies with Box2D !</div></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6389}" id="post-6389" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-20 07:32:33" class="post_date"><a href="https://itch.io/post/6389">2 years ago</a></span> <span class="edit_message">(Edited 2 times)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h3>Box2D (1/2)</h3><p>OK, we now have a level created ! Now it's time to read this map, and create the bodies !</p><p>First, we'll create a <em>GameConstants</em>
 class, that will contain a lot of constants that we need to have access
 during the game. That we'll make things easier to handle.</p><p>Here is the <strong>GameConstants.java</strong> :</p><pre>public class GameConstants {
    //World constants
    public static float MPP = 0.05f;            //Meter/Pixel
    public static float PPM = 1/MPP;            //Pixel/Meter
    public static float BOX_STEP = 1/60f; 
    public static int BOX_VELOCITY_ITERATIONS = 6;
    public static int BOX_POSITION_ITERATIONS = 2;
    public static float GRAVITY = 0;
    public static float DENSITY = 1.0f;
    
    //Tiled Map constants
    public static int PPT = 32;                    //Pixel/Tile
    
    //Screen constants
    public static int NB_HORIZONTAL_TILE = 50;
    public static float SCREEN_WIDTH = MPP * NB_HORIZONTAL_TILE * PPT;
    public static float SCREEN_RATIO = (float)Gdx.graphics.getHeight()/(float)Gdx.graphics.getWidth();
    public static float SCREEN_HEIGHT = SCREEN_WIDTH * SCREEN_RATIO;
    
    //Hero constants
    public static float HERO_HEIGHT = 1.5f * PPT * MPP / 2;
    public static float HERO_WIDTH = HERO_HEIGHT / 2;
    public static float JETPACK_IMPULSE = 100;
    public static float TOM_ROTATION = 5;
}
</pre><ul><li>There are World constants that are relative to Box2D. MPP and PPM are <strong>very</strong>
 important : By default in Box2D, 1 pixel = 1 m. Thus, the object you 
create by default are HUGE. And the Box2D simulation doesn't work for 
huge sizes and huge mass. Therefore the <em>MPP</em> and <em>PPM</em> factor conversions will be used to scale down the world and to sprites. For now I chose a conversion of 20 pixels for 1 meter.</li><li>There
 is also the Tiled Map Constant that is simply the size of one tile, 32 
pixels in my case. That will be important to set up the camera.</li><li>The
 screen constants, that are actually camera constants, are there simply 
to chose the size of the viewport. For example, I chose I wanted my 
camera to display 50 tiles on the width. The number of tiles that will 
be displayed on the height will depend on the screen ratio.</li><li>An then I created the hero constants : His size, the power of his jetpack and the rotation speed.</li></ul><p>All
 these are only starting values. As the development goes by, I will 
certainly modify these values according to the gameplay I want.</p><p>Now that we have these constants, we need a <em>TiledMapReader</em> to read the map we created and created bodies :</p><p>Here is the <strong>TiledMapReader.java</strong> :</p><pre>public class TiledMapReader {

    private OrthographicCamera camera;
    private World world;
    private MapObjects objects;
    public Array&lt;Obstacle&gt; obstacles;
    public Hero hero;
    
    public TiledMapReader(final MyGdxGame game, TiledMap tiledMap, World world, OrthographicCamera camera){
        this.camera = camera;
        this.world = world;
        
        hero = new Hero(world, camera, tiledMap);
        
        objects = tiledMap.getLayers().get("Objects").getObjects();

        obstacles = new Array&lt;Obstacle&gt;();    
        
        for (RectangleMapObject rectangleObject : objects.getByType(RectangleMapObject.class)) {
            Obstacle obstacle = new Obstacle(world, camera, rectangleObject);
            obstacles.add(obstacle);
        }
    }
}
</pre><p>You can see, this calsse reads reads the <em>tiledMap</em> and create the hero and the objects. The <em>TiledMapReader</em>
 class read the layer, and find the layer called "Objects" in which I 
created the walls, and returns the object found in this layer. Then, for
 each object in this layer, if the object is a rectangle, we create an <em>Obstacle</em> and we put it in an <em>Obstacle Array.</em></p><p>Here is the class <strong>Hero.java </strong>:</p><pre>public class Hero {

    public Body heroBody;
    private BodyDef bodyDef;
    private FixtureDef fixtureDef;
    private PolygonShape heroShape;
    private float width, height, posXInit, posYInit;
    private Vector2 direction;
    
    public Hero(World world, Camera camera, TiledMap tiledMap){

        MapObjects personnages = (MapObjects)tiledMap.getLayers().get("Spawn").getObjects();

        width = GameConstants.HERO_WIDTH;
        height = GameConstants.HERO_HEIGHT;
        posXInit = (personnages.get("Tom").getProperties().get("x", float.class) + personnages.get("Tom").getProperties().get("width", float.class)/2) * GameConstants.MPP;
        posYInit = (personnages.get("Tom").getProperties().get("y", float.class) + personnages.get("Tom").getProperties().get("height", float.class)/2) * GameConstants.MPP;
        direction = new Vector2();
        
        heroShape = new PolygonShape();
        heroShape.setAsBox(width, height);
        
        bodyDef = new BodyDef();
        bodyDef.position.set(posXInit, posYInit);
        bodyDef.type = BodyType.DynamicBody; 
        
        heroBody = world.createBody(bodyDef);
        heroBody.setFixedRotation(false);
            
        fixtureDef = new FixtureDef();  
        fixtureDef.shape = heroShape; 
        fixtureDef.density = (float)(GameConstants.DENSITY/(width * height));
        fixtureDef.friction = 0.01f;  
        fixtureDef.restitution = 0.1f;  
        heroBody.createFixture(fixtureDef).setUserData("Tom"); 
        heroBody.setUserData("Tom");
        
        heroShape.dispose();
    }
    
    public void displacement(){    
        if(Gdx.input.isKeyPressed(Keys.W)){
            heroBody.applyForceToCenter(new Vector2(0, GameConstants.JETPACK_IMPULSE).rotate(heroBody.getAngle() * MathUtils.radiansToDegrees), true);
        }
        
        if(Gdx.input.isKeyPressed(Keys.A))
            heroBody.setAngularVelocity(GameConstants.TOM_ROTATION);
        else if(Gdx.input.isKeyPressed(Keys.D))
            heroBody.setAngularVelocity(- GameConstants.TOM_ROTATION);
        else
            heroBody.setAngularVelocity(0);
    }
    
    public float getX(){
        return heroBody.getPosition().x;
    }
    
    public float getY(){
        return heroBody.getPosition().y;
    }
    
    public Vector2 getOrigine(){
        return new Vector2(posXInit, posYInit);
    }
}
</pre><p>The <em>Hero</em> class reads the tiledMap, find the layer 
called "Spawn" and look for an object called "Tom". Then it get the 
coordinate of Tom and creates a body at this coordinates. This class 
contains a <em>displacement()</em> method to control the hero with WAD keys. There are also few others method that could be useful during the development.</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6390}" id="post-6390" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-20 07:33:37" class="post_date"><a href="https://itch.io/post/6390">2 years ago</a></span> <span class="edit_message">(Edited 2 times)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h3>Box2D (2/2)</h3><p>Here is the <strong>Obstacle.java </strong>:</p><pre>public class Obstacle {
    
    public Body body;
    protected BodyDef bodyDef;
    protected FixtureDef fixtureDef;
    protected PolygonShape polygonShape;
    public float posX, posY, width, height, angle;
    Camera camera;
    
    public Obstacle(World world, Camera camera, MapObject rectangleObject){        
        create(world, camera, rectangleObject);     
    }
    
    public void create(World world, Camera camera, MapObject rectangleObject){

        Rectangle rectangle = ((RectangleMapObject) rectangleObject).getRectangle();
            
        this.camera = camera;
        this.posX = (rectangle.x + rectangle.width/2) * GameConstants.MPP;
        this.posY = (rectangle.y + rectangle.height/2) * GameConstants.MPP;
        this.width = (rectangle.width/2) * GameConstants.MPP;
        this.height = (rectangle.height/2) * GameConstants.MPP;
        
        if(rectangleObject.getProperties().get("rotation") != null)
            this.angle = -Float.parseFloat(rectangleObject.getProperties().get("rotation").toString())*MathUtils.degreesToRadians;
        
        polygonShape = new PolygonShape();
        polygonShape.setAsBox(width, height);


        bodyDef = new BodyDef();
        bodyDef.position.set(new Vector2(posX, posY));
        bodyDef.type = getBodyType();
        body = world.createBody(bodyDef);
        
        fixtureDef = new FixtureDef();
        fixtureDef.shape = polygonShape;
        fixtureDef.density = (float)(GameConstants.DENSITY/(width * height));  
        fixtureDef.friction = 0.5f;  
        fixtureDef.restitution = 0.5f;
   
        body.createFixture(fixtureDef).setUserData("Obstacle");
        body.setUserData("Obstacle");
        
        if(rectangleObject.getProperties().get("rotation") != null){
            /*
             * To obtain x' et y' positions from x et y positions after a rotation of an angle A
             * around the origine (0, 0) :
             * x' = x*cos(A) - y*sin(A)
             * y' = x*sin(A) + y*cos(A)
             */
            float X = (float)(body.getPosition().x - width + width * Math.cos(angle) + height * Math.sin(angle));
            float Y = (float)(width * Math.sin(angle) + body.getPosition().y + height - height * Math.cos(angle));
            body.setTransform(X, Y, this.angle);
        }
        
        polygonShape.dispose();  
    }
    
    public float getWidth(){
        return width;
    }
    
    public float getHeight(){
        return height;
    }
    
    public float getX(){
        return posX;
    }
    
    public float getY(){
        return posY;
    }

    public void setX( float X){
        posX = X;
    }

    public void setY( float Y){
        posY = Y;
    }

    public void active(){     
    }
<span>
    </span>public BodyType getBodyType(){
        return BodyType.StaticBody;
    }
}
</pre><p>The <em>Obstacle </em>classe takes a RectangleMapObject given by the <em>TiledMapReader</em>
 and create a body using the coordinates and the size of the 
RectangleMapObject. The Obstacle classe as been thought to be a extended
 to create other obstacles, with different properties (moving obstacle, 
light or heavy obstacles...).</p><p>You can see in my code something that ight look not usual : The density of the obstacle is expressed like this :</p><p><em>fixtureDef.density = (float)(GameConstants.DENSITY/(width * height));</em> The reason is that it will allow me to easily control the mass of every object later.</p><p>OK, now we converted the Tiled Map into bodies with Box2D, now it's the time to have fun !!</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6391}" id="post-6391" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-20 07:34:31" class="post_date"><a href="https://itch.io/post/6391">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h3>libGDX</h3><p>Finally, let's modify the GameScreen !</p><p>Here is the <strong></strong><strong>GameScreen.java </strong>:</p><pre>public GameScreen(final MyGdxGame game){
        this.game= game;

        camera = new OrthographicCamera();
        camera.setToOrtho(false, GameConstants.SCREEN_WIDTH, GameConstants.SCREEN_HEIGHT);
        camera.update();  
        
        world = new World(new Vector2(0, GameConstants.GRAVITY), true);
        World.setVelocityThreshold(0.0f);
        debugRenderer = new Box2DDebugRenderer();
        
        tiledMap = new TmxMapLoader().load("Levels/Level 1.tmx");
        tiledMapRenderer = new OrthogonalTiledMapRendererWithSprites(tiledMap, GameConstants.MPP, game.batch);

        mapReader = new TiledMapReader(game, tiledMap, world, camera); 
    }

    @Override
    public void render(float delta) {  
        Gdx.gl.glClearColor(0, 0, 0, 1);
        Gdx.gl.glClear(GL20.GL_COLOR_BUFFER_BIT);
        camera.update();
        
        world.step(GameConstants.BOX_STEP, GameConstants.BOX_VELOCITY_ITERATIONS, GameConstants.BOX_POSITION_ITERATIONS); 
        debugRenderer.render(world, camera.combined);    

        mapReader.hero.displacement();
    }
}<br></pre><ul><li>In the constructor I create the <em>camera</em>, with the size I define in the <em>GameConstants.java</em>, then I create the <em>World</em>. The line <em>World.setVelocityThreshold(0.0f);</em>
 allows object to move very slowly. This is not mandatory, but I like it
 that way. Then I create a debugRenderer, because I still have no 
graphics, so the debugRenderer is the only way to visualize our work. 
Finally, I create, the <em>tiledMap</em>, the <em>tiledMapRenderer</em> and the <em>TiledMapReader</em>.</li></ul><p>Notice that the <em>tiledMapRenderer</em> is an <a href="https://github.com/sallax/tilemaptest/blob/master/core/src/com/mygdx/tile/OrthogonalTiledMapRendererWithSprites.java" rel="nofollow noopener">OrthogonalTiledMapRendererWithSprites</a> that I modified to take into account the Box2D conversion factor. The code will follow next.</p><ul><li>In the <em>render()</em>,
 we need to clear the screen and update the camera, then run the Box2D 
simulation. The we run the debugRenderer to display the Box2D bodies, 
and finally we run the <em>displacement() </em>method to control the hero with the keyboard.</li></ul><p>Here is the result when we run the game ! Pretty fun hu ?</p><p><img src="blog_fichiers/127351libGDXJam1.gif"> <br></p><p><span>Here is the <strong>OrthogonalTiledMapRendererWithSprites.java</strong> :</span></p><pre>public class OrthogonalTiledMapRendererWithSprites  extends OrthogonalTiledMapRenderer{
    float unitScale = 1;
    
    public OrthogonalTiledMapRendererWithSprites(TiledMap map, Batch batch) {
        super(map, batch);
    }

    //Constructor that takes into account the Box2D scale (MPP) to render the sprites at the same size as the BOx2D bodies
    public OrthogonalTiledMapRendererWithSprites (TiledMap map, float unitScale, Batch batch) {
        super(map, unitScale, batch);
        
        this.unitScale = unitScale;
    }

    //Proceduraly draw the sprites we'll add to an object layer in our tiled map
    @Override
    public void renderObject(MapObject object) {
        if(object instanceof TextureMapObject) {
            TextureMapObject textureObj = (TextureMapObject) object;
            
            batch.draw(textureObj.getTextureRegion(), 
                        textureObj.getX(), 
                        textureObj.getY(), 
                        textureObj.getTextureRegion().getRegionWidth() * unitScale, 
                        textureObj.getTextureRegion().getRegionHeight() * unitScale);
        }
    }
}<br></pre><p>That's all for today !</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:48652,&quot;id&quot;:6395}" id="post-6395" class="community_post has_replies deleted"><em class="deleted_message">Deleted post</em></div><div class="community_post_replies top_level_replies"><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6532}" id="post-6532" class="community_post is_reply"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/25x25%23/dffXN7.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-21 04:36:49" class="post_date"><a href="https://itch.io/post/6532">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><p>Thanks ! I'll do my best, for both the game and the devlog !</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6539}" id="post-6539" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-21 05:51:31" class="post_date"><a href="https://itch.io/post/6539">2 years ago</a></span> <span class="edit_message">(Edited 1 time)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Setting up the camera behavior</h1><p>On
 the first gif I posted, at the end of the previous post, you can see 
that the camera doesn't move. It doesn't follow the hero, and at the end
 of the animation, the hero leaves the screen. We need to make the 
camera follow the hero. For exemple, we could center the camera on the 
hero. Thus the hero woul always appears exactly at the center of the 
screen. But that's not always the most eye pleasing choice. What I 
prefer is to determine a zone, at the center of the screen. If the hero 
is in this zone, the camera doesn't move, if the hero leaves this zone, 
the camera follows the hero. Plus, I don't want the camera to go outside
 of the map limit. Therefore, if the hero is in a corner, for example 
bottom left corner of the map, the camera won't go over the map limit in
 order to respect the condition "The hero must stay in the define zone".
 In this case, the hero will appear at the bottom left corner of the 
camera.</p><p>Here is an illustration :</p><p><img src="blog_fichiers/501844Screen.jpg"><span></span></p><p>For that, in the <em>GameScreen.java</em>, I'll replace the <em>OrthographicCamera</em> by a camera that I'll call <em>MyCamera</em>, that extends <em>OrthographicCamera</em>.</p><p>Here is the code for <strong>MyCamera.java</strong> :</p><pre>public class MyCamera extends  OrthographicCamera{
    
    float posX, posY;
    
    public MyCamera(){
        super();
    }
 
    public void displacement(Hero hero, TiledMap tiledMap){
        //Positioning relative to the hero
        if(this.position.x &lt; hero.getX() - Gdx.graphics.getWidth() * GameConstants.MPP/10)
            posX = hero.getX() - Gdx.graphics.getWidth() * GameConstants.MPP/10;
        else if(this.position.x &gt; hero.getX() + Gdx.graphics.getWidth() * GameConstants.MPP/10)
            posX = hero.getX() + Gdx.graphics.getWidth() * GameConstants.MPP/10;
        if(this.position.y &lt; hero.getY() - Gdx.graphics.getHeight() * GameConstants.MPP/10)
            posY = hero.getY() - Gdx.graphics.getHeight() * GameConstants.MPP/10;
        else if(this.position.y &gt; hero.getY() + Gdx.graphics.getHeight() * GameConstants.MPP/10)
            posY = hero.getY() + Gdx.graphics.getHeight() * GameConstants.MPP/10;
        
        //Camera smooth motion
        this.position.interpolate(new Vector3(posX,posY,0), 0.45f, Interpolation.fade);
        
        //Positioning relative to the level map limits
        if(this.position.x + this.viewportWidth/2 &gt; ((float)(tiledMap.getProperties().get("width", Integer.class)*GameConstants.PPT))*GameConstants.MPP)
            this.position.set(((float)(tiledMap.getProperties().get("width", Integer.class)*GameConstants.PPT))*GameConstants.MPP - this.viewportWidth/2, this.position.y, 0);
        else if(this.position.x - this.viewportWidth/2 &lt; 0)
            this.position.set(this.viewportWidth/2, this.position.y, 0);
        if(this.position.y + this.viewportHeight/2 &gt; ((float)(tiledMap.getProperties().get("height", Integer.class)*GameConstants.PPT))*GameConstants.MPP)
            this.position.set(this.position.x, ((float)(tiledMap.getProperties().get("height", Integer.class)*GameConstants.PPT))*GameConstants.MPP - this.viewportHeight/2, 0);
        else if(this.position.y - this.viewportHeight/2 &lt; 0)
            this.position.set(this.position.x, this.viewportHeight/2, 0);    
    }
}
</pre><p>What is important in <em>MyCamera</em>, is the <em>displacement()</em> method :</p><ol><li>I check if the camera position (<em>this.position.x</em> and <em>this.position.y</em>) is inside a rectangle centered on the hero, of width 20% of the screen width (<em>Gdx.graphics.getWidth() * GameConstants.MPP/10</em>)
 and of height 20% of the screen height. If the camera is not in this 
rectangle, I update variables posX and posY in order to make the hero 
appear exactly at the border of this rectangle, not in the center, 
otherwise the camera would have a jerky motion.</li><li>I interpolate 
the position of the camera, so transition is smooth. You can modify the 
speed of this interpolation by the second parameter (that is <em>0.45f</em> in my case). The higher this parameter, the quicker the camera motion.</li><li>Finally,
 I check if after moving the camera, the camera went over the map limit.
 If yes, I move back the camera in order to exactly fit the border of 
the map with the border of the screen.</li></ol><p>Here is the result :</p><p><img src="blog_fichiers/214219libGDXJam2.gif"><span></span></p><p>Notice
 that in my exemple, the map is 50 tiles wide, and the I setted up the 
camera in order to display 50 tiles on the width. Thus, the camera 
doesn't move on the side, in order to don't go over the map border.</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6541}" id="post-6541" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-21 06:37:57" class="post_date"><a href="https://itch.io/post/6541">2 years ago</a></span> <span class="edit_message">(Edited 1 time)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Work on the hero</h1><h2>Losing condition : Oxygen and fuel levels</h2><p>In
 my game, my hero's spaceship is wrecked : The oxygen leaked and the 
artificial gravity module (Yes that exists in my game !) is out of 
order. The hero must use is jetpack equipped spacesuit to travel across 
his spaceship and reach the safety spaceship. While traveling, the hero 
must take care 2 parameters :</p><ol><li>Oxygen level : The oxygen level decrease with the time. When it reaches 0, the hero dies.</li><li>Fuel
 level : The fuel level decrease every time the hero activate his 
jetpack to create an impulse. When the fuel level reaches 0, the hero 
can no longer move.</li></ol><p>First, we'll add some constants to the <strong>GameConstants.java</strong> :</p><pre>public class GameConstants {&lt;span class="redactor-invisible-space"&gt;
&lt;span class="redactor-invisible-space"&gt;    ...
&lt;/span&gt;&lt;/span&gt;
    //Hero constants
    public static float HERO_HEIGHT = 1.5f * PPT * MPP / 2;
    public static float HERO_WIDTH = HERO_HEIGHT / 2;
    public static float JETPACK_IMPULSE = 100;
    public static float TOM_ROTATION = 5;
    public static float MAX_OXYGEN = 120;
    public static float MAX_FUEL = 100;
    public static float FUEL_CONSUMPTION = 5;

    ...
}</pre><p>You can see that in the <em>Hero constants</em> block I added 3 constants :</p><ol><li>MAX_OXYGEN : basically, it's the number of second you can last when the oxygen level is at 100%</li><li>MAX_FUEL : The maximum amount of fuel</li><li><span>FUEL_CONSUMPTION : The amount of fuel you burn for a 1 second impulse.</span></li></ol><p>Then, we need to modify the <strong>Hero.java</strong> (I only show the difference with the previous code) :</p><pre>public class Hero {

    ...  
    private float oxygenLevel, fuelLevel;
    
    public Hero(World world, Camera camera, TiledMap tiledMap){

        ...
        oxygenLevel = GameConstants.MAX_OXYGEN;
        fuelLevel = GameConstants.MAX_FUEL;
        ....
    }
    
    public void displacement(){    
        oxygenLevel -= Gdx.graphics.getDeltaTime();
        
        if(Gdx.input.isKeyPressed(Keys.W)){
            heroBody.applyForceToCenter(new Vector2(0, GameConstants.JETPACK_IMPULSE).rotate(heroBody.getAngle() * MathUtils.radiansToDegrees), true);
            fuelLevel -= Gdx.graphics.getDeltaTime() * GameConstants.FUEL_CONSUMPTION;
        }
        
        if(Gdx.input.isKeyPressed(Keys.A))
            heroBody.setAngularVelocity(GameConstants.TOM_ROTATION);
        else if(Gdx.input.isKeyPressed(Keys.D))
            heroBody.setAngularVelocity(- GameConstants.TOM_ROTATION);
        else
            heroBody.setAngularVelocity(0);
    
        System.out.println("FuelLevel = " + fuelLevel + " || OxygenLevel = " + oxygenLevel);
    }

    public float getOxygenLevel(){
        return oxygenLevel;
    }
    
    public float getFuelLevel(){
        return fuelLevel;
    }
} 
</pre><p>You can see that I created the 2 float <em>oxygenLevel </em>and <em>fuelLevel</em>, and I initiate them with their Max values in the creator. Then, in the <em>displacement()</em>, I added <br></p><pre>oxygenLevel -= Gdx.graphics.getDeltaTime();</pre><p>which makes the <em>oxygenLevel</em> decrease by one unit every second. I think I should rename the <em>displacement()</em> method, since it not only deal with the hero displacement now...</p><p>I also modify the action when we press the W key :</p><pre>if(Gdx.input.isKeyPressed(Keys.W)){ 
    heroBody.applyForceToCenter(new Vector2(0, GameConstants.JETPACK_IMPULSE).rotate(heroBody.getAngle() * MathUtils.radiansToDegrees), true); 
    fuelLevel -= Gdx.graphics.getDeltaTime() * GameConstants.FUEL_CONSUMPTION; 
}</pre><p>Now when we press the W key, the <em>fuelLevel</em> decreases by <em>GameConstants.FUEL_CONSUMPTION</em> units every second.</p><p>In order to monitor the <em>oxygenLevel</em> and the <em>fuelLevel</em> in the console, I also added :</p><pre>System.out.println("FuelLevel = " + fuelLevel + " || OxygenLevel = " + oxygenLevel);</pre><p>And here is an illustration of the oxygen and fuel consumption :</p><p><img src="blog_fichiers/131317libGDXJam3.gif">You can see in the console that the <em>FuelLevel</em> doesn't decrease when no impulse is applied to the hero, while the <em>OxygenLevel</em> decreases all along the animation.</p><p><br></p><p>Finally, to be able to lose, in the <em>render()</em> of the <em>GameScreen</em> we need to add some code to check the <em>oxygenLevel</em> and <em>fuelLevel</em>, and if one of these falls under 0, the player loses.</p><p>For now, we'll only print a message in the console, when the player loses. In the <em>render()</em> of the <em>GameScreen</em> I added :</p><pre>if(mapReader.hero.getOxygenLevel() &lt; 0 || mapReader.hero.getFuelLevel() &lt; 0)
            System.out.println("You lose !");
</pre><hr><p><strong><u>Edit :</u></strong> I decided to change the 
losing condition : Now we lose only if the hero is out of oxygen. It 
makes more sense. Even if the hero is out of fuel for his jetpack, he 
still can finish the level if he reaches the exit fo the room. For 
example, you have just enough of fuel to create one last impulse to 
direct your hero towards the exit door. Once the jetpack is out of fuel,
 without air friction and gravity, the hero will keep going in the same 
direction. If he reaches the exit door before being out of oxygen, he 
succeeds in passing the level.</p><p>Thus, in the <em>render()</em> of the <em>GameScreen</em> I have now :</p><pre>if(mapReader.hero.getOxygenLevel() &lt; 0) 
    System.out.println("You lose !");</pre><p>In the future I'll have to
 create a pop-up box that asks the player if he wants to restart the 
level when he is out of fuel, in order to prevent the player from 
waiting to be out of oxygen when he has no more fuel and no hope to 
reach the exit.</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6669}" id="post-6669" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-22 00:28:31" class="post_date"><a href="https://itch.io/post/6669">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Winning condition : Exiting the room</h1><p>To
 finish a level, you simply need to reach the exit of the room you are 
in. To detect the exit of the room, I created a body, and when the hero 
collides with this body, the room is exited !</p><p><strong>First, an <em>Exit</em> class, that is a subclass from my<em>Obstacle</em>  class <span></span>is created.</strong></p><p>Here is the <strong>Exit.java</strong> :</p><pre>public class Exit extends Obstacle{
    
    public Exit(World world, Camera camera, MapObject rectangleObject) {
        super(world, camera, rectangleObject);
        
        body.getFixtureList().get(0).setSensor(true);
        body.getFixtureList().get(0).setUserData("Exit");
        body.setUserData("Exit");
    }
}<br></pre><p>The difference between an <em>Exit</em> and an <em>Obstacle</em> are :</p><ul><li>The <em>Exit</em> is a <em>sensor</em> (<em>body.getFixtureList().get(0).setSensor(true);</em>).
 That means that the Exit body will detect collisions but there won‚Äôt be
 any physical response to this collision : The hero can pass throug the 
Exit.</li><li>The <em>user data</em> of the Exit‚Äôs body and fixture are set to "Exit" instead of "Obstacle" (<em>.setUserData("Exit")</em>): This will allow us to make the difference between the collision with an <em>Obstacle</em> and the <em>Exit</em>.</li></ul><div><strong>Once the Exit class created, we need to add an Exit to our level</strong></div><div>For
 that we use the Tiled editor and create a rectangle. Then, we'll use 
one of the most useful feature of Tiled : We'll create a property in our
 rectangle and we'll call it "Type" and we'll give the value "Exit" :</div><p><img src="blog_fichiers/d2YXafelAE8el8zK.gif"><span></span></p><p><strong>Then the TiledMapReader needs to recognize the Exit</strong></p><p>Here is the new <strong>TiledMapReader.java</strong> :</p><pre>public class TiledMapReader {

    private OrthographicCamera camera;
    private World world;
    private MapObjects objects;
    public Array&lt;Obstacle&gt; obstacles;
    public Hero hero;
    
    public TiledMapReader(final MyGdxGame game, TiledMap tiledMap, World world, OrthographicCamera camera){
        this.camera = camera;
        this.world = world;
        
        hero = new Hero(world, camera, tiledMap);
        
        objects = tiledMap.getLayers().get("Objects").getObjects();

        obstacles = new Array&lt;Obstacle&gt;();    
        
        for (RectangleMapObject rectangleObject : objects.getByType(RectangleMapObject.class)) {
            if(rectangleObject.getProperties().get("Type") != null){
                //End of the level
                if(rectangleObject.getProperties().get("Type").equals("Exit")){
                    Exit finish = new Exit(world, camera, rectangleObject);
                    obstacles.add(finish);
                }
            }
            else{
                Obstacle obstacle = new Obstacle(world, camera, rectangleObject);
                obstacles.add(obstacle);
            }
        }
    }
}<br></pre><p>Modifications with the previous <em>TiledMapReader.java</em> :</p><ul><li>In the <em>for</em> loop we add an <em>if</em>,
 that will check if the rectangle has a property called "Type". To 
access to the properties of a rectangle object, you need to do : <em>rectangleObject.getProperties()</em></li><li>If the rectangle has a property called "Type"<span>, we check if the "Type" property as the value "Exit"<br></span></li><li><span>If the value of <em>Type</em> is <em>Exit</em>, we create an <em>Exit</em>, and add it to the <em>obstacles</em> Array</span></li><li><span>If the rectangle doesn‚Äôt have a property called "Type"<span>, we create an <em>Obstacle</em>.<br></span></span></li></ul><div><strong>Finally, in the GameScreen, we set a contactListener detecting the collision between bodies </strong></div><div>The contactListener will be in the <strong>show()</strong> of the <strong>GameScreen.java</strong> :</div><pre>@Override
    public void show() {
        world.setContactListener(new ContactListener(){
            @Override
            public void beginContact(Contact contact) {
                Body bodyA = contact.getFixtureA().getBody();
                Body bodyB = contact.getFixtureB().getBody();
                
                if(bodyA.getUserData() != null &amp;&amp; bodyB.getUserData() != null) {
                    //Finish the level
                    if(bodyA.getUserData().equals("Tom") &amp;&amp; bodyB.getUserData().equals("Exit"))
                        System.out.println("LEVEL FINISHED !!!!");
                    else if(bodyB.getUserData().equals("Tom") &amp;&amp; bodyA.getUserData().equals("Exit"))
                        System.out.println("LEVEL FINISHED !!!!");
                }
            }

            @Override
            public void endContact(Contact contact) {
            }

            @Override
            public void preSolve(Contact contact, Manifold oldManifold) {
            }

            @Override
            public void postSolve(Contact contact, ContactImpulse impulse) {               
            }
        });
    }<br></pre><p>The contactListener includes 4 methods :</p><ol><li><strong>beginContact</strong> : Called when two fixtures start collide. You can trigger events when two bodies collide.</li><li><strong>endContact</strong> : Called when two fixtures stop being in contact. Same thing, you can trigger whatever you want at this moment.</li><li><strong>preSolve</strong>
 : Called before the contact is processed, it means before the 
simulation of this collision runs, before the beginContact. Very useful 
to ignore some contacts.</li><li><strong>postSolve</strong> : Called after the contact is processed.</li></ol><div>In our case we use the <em>beginContact</em> to detect collisions between the <em>Hero</em> and the <em>Exit</em>.
 For that, we check if the UserData of the fixtures that collide are 
"Exit" and "Tom". If yes, we print "LEVEL FINISHED !!!!" in the console.</div><div><img src="blog_fichiers/26tPgDTtkwgaF9DP2.gif"><br></div><div>That's it ! So far, so good. We have a fully playable game :</div><ul><li>A start point</li><li>A finish point</li><li>We can control the hero</li><li>We have winning and losing conditions</li></ul><div><strong>Now, we need to add fun to this !</strong></div></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6697}" id="post-6697" class="community_post has_replies sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-22 04:47:04" class="post_date"><a href="https://itch.io/post/6697">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Adding some fun : Light Obstacles</h1><p>The
 next step in the development of this game is adding several types of 
obstacles to enhance the gameplay. I‚Äôll start by adding light obstacles,
 that hero can push.</p><p><strong>For that, let‚Äôs start by creating the <em>ObstacleLight</em>, that is obviously a subclass of <em>Obstacle</em>.</strong></p><p>Here is the <strong>ObstacleLight.java</strong> :</p><pre>public class ObstacleLight extends Obstacle{

    public ObstacleLight(World world, Camera camera, MapObject rectangleObject) {
        super(world, camera, rectangleObject);
        
        body.setUserData("ObstacleLight");
        body.getFixtureList().get(0).setUserData("ObstacleLight");
        
        //Weight
        if(rectangleObject.getProperties().get("Weight") != null){
            body.getFixtureList().get(0).setDensity(
                    body.getFixtureList().get(0).getDensity() * Float.parseFloat(rectangleObject.getProperties().get("Weight").toString())
            );
            body.resetMassData();
        }
    }
    
    @Override
    public BodyType getBodyType(){
        return BodyType.DynamicBody;
    }
}<br></pre><p>Differences with the <em>Obstacle</em> class :</p><ul><li> The UserData of the body and fixture ane "ObstacleLight" instead of "Obstacle"</li><li>The BodyType is a <em>DynamicBody</em>, which means that the body will move under the action of forces (collision, gravity...)</li><li>The <em>ObstacleLight</em>
 can have various weights, depending on the value we give to the 
property "Weight" in the Tiled map editor. If we don‚Äôt put a property 
"Weight", the <em>ObstacleLight</em> will have a default weight, which is the same weight as the hero.</li></ul><div><br></div><div>Talking about the weight, and the density, it‚Äôs time to explain the way I deal with this :</div><div>In
 Box2D, to create a Body, you first need to create a Fixture. The Body 
will be then created from this fixture, and some other properties you 
put in the BodyDef. Each Fixture will have a weight. But you can‚Äôt set 
the weight in Box2D. Instead you set the density of the Fixture with</div><pre>fixtureDef.density</pre>and the weight is calculated like this : weight = density * area of the shape.<p>The shape is also included in the Fixture by </p><pre>fixtureDef.shape = shape</pre><p>For that you use a Shape you created earlier, that can be a PolygonShape or a CircleShape.</p><p>Thus, for example, for a rectangle, the weight will be : weight  = density * width * height.</p><p>The bigger, the heavier. Which is logical.</p><p>But,
 for my game I want a way to control precisely the weight of every 
Obstacle in my game, without having to do some calculation. Therefore, 
in my game, EVERY bodies will have the exact same weight by default. For
 that, I create a constant in the GameConstants, for the density :</p><pre>public static float DENSITY = 1.0f;</pre><p>And the default density of the fixture of every object is defined like this (Example of a rectangle box):</p><pre>fixtureDef.density = (float)(GameConstants.DENSITY/(width * height));</pre><p>I divide GameConstants.Density by the area of the fixture : The bigger, the least dense, and the weight is stable.</p><p><br></p><p>Why the hell do I need to work like that ?</p><p>Because
 it‚Äôs very easy to manage. For example, when I put obstacles in my level
 editor, and I want my hero to interact with the object, I don‚Äôt need to
 calculate what density I need to give to each obstacle, according to 
the difficulty I want the hero having to push these objects. With my 
system, every object will have the same weight as the hero by default. 
Thus I know that the hero can push them with a moderate effort, meaning,
 a moderate fuel consumption. If I want the hero to have trouble pushing
 an object I only need to add a property "Weight", and attribute it a 
high value, say 10, and I‚Äôll know that this object will weigh 10 times 
more than the hero. If I want a really light object, I‚Äôll attribute a 
low value to "Weight", say 0.1f, and I‚Äôll know that the hero can 
displace it with no effort. And I can do that independently of the size 
of the object, which gives a great liberty for designing levels.</p><p><br></p><p><strong>Then we need to modify the TiledMapReader to recognize the ObstacleLight</strong></p><p>Thus, the <em>for</em> loop of the <strong>TiledMapReader.java</strong> becomes :</p><pre>for (RectangleMapObject rectangleObject : objects.getByType(RectangleMapObject.class)) {
            if(rectangleObject.getProperties().get("Type") != null){
                //End of the level
                if(rectangleObject.getProperties().get("Type").equals("Exit")){
                    Exit finish = new Exit(world, camera, rectangleObject);
                    obstacles.add(finish);
                }
                //Light obstacles
                else if(rectangleObject.getProperties().get("Type").equals("Light")){
                    ObstacleLight obstacle = new ObstacleLight(world, camera, rectangleObject);
                    obstacles.add(obstacle);
                }
            }
            else{
                Obstacle obstacle = new Obstacle(world, camera, rectangleObject);
                obstacles.add(obstacle);
            }
        }<br></pre><p><strong>All that remains is to add ObstacleLight to the level in Tiled</strong><span></span></p><p>For that, you only need to create rectangles and give a property "Type" with the value "Light". The created <em>ObstacleLight</em> will have the same weight as the hero by default, but just add a property "Weight" with any value to modify their weight.</p><p>And here is the result !</p><p><img src="blog_fichiers/d2YZVqyOQZ5u3HAQ.gif"><span></span><br></p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div class="community_post_replies top_level_replies"><div data-post="{&quot;user_id&quot;:50635,&quot;id&quot;:6731}" id="post-6731" class="community_post has_replies is_reply"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/yellowbyte" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvNTA2MzUvMzcxNDQwLmpwZw==/25x25%23/ioikAh.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/yellowbyte">Yellowbyte</a></span><span title="2015-12-22 15:33:41" class="post_date"><a href="https://itch.io/post/6731">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><p>Nice, this looks like a lot of fun!</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div class="community_post_replies"><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6762}" id="post-6762" class="community_post is_reply"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/25x25%23/dffXN7.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-22 19:57:48" class="post_date"><a href="https://itch.io/post/6762">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><p>Thanks !</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6796}" id="post-6796" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-23 00:24:33" class="post_date"><a href="https://itch.io/post/6796">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Animated Obstacles : Piston (1/2)</h1><p>Next type of Obstacle : Piston</p><p>With this Obstacle, we increase the complexity in our code : The piston needs 2 fixtures (<em>Head </em>and <em>Axis</em>),
 and it needs to move. This will give us the opportunity to create traps
 for the hero, and also the opportunity to have another losing condition
 : Hero gets crushed.</p><p>Here is a short video showing the process of creating the <em>Pistons</em> with <em>Tiled </em>and the result after running the code :</p><p><iframe src="blog_fichiers/V2cj9kZXEqA.html" allowfullscreen="" width="500" height="281" frameborder="0"></iframe></p><p><span></span><strong>Creating the Piston in Tiled</strong></p><p> In Tiled, for each Piston, we need to draw 2 <em>Fixtures</em>, one for the Head and one for the Axis of the Piston. The TiledMapReader will need to know that the 2 <em>Rectangles</em> we drew are connected to form a <em>Piston</em>, otherwise, the TiledMapReader will convert these 2 Rectangles in 2 simple <em>Obstacles</em>, it is to say, 2 walls.</p><p>To show that these 2 <em>Rectangles</em>
 form a Piston, will simply add a property called "Group" to these 2 
Rectangles, and we‚Äôll attribute the same value to, say 1, to the 
property "Group" of the 2 <em>Rectangles</em>. Of course, if we create several <em>Pistons</em>, for example 4 <em>Pistons</em>, we will have Group 1, Group 2, Group 3, and Group 4.</p><p><strong>Now let‚Äôs see the code</strong></p><p>Here is the code for <strong>ObstaclePiston.java</strong> :</p><pre>public class ObstaclePiston extends Obstacle{

    private PolygonShape shape2;
    private float width2, height2, posX2, posY2;
    private float speed = 10;
    private float delay = 0;
    private Vector2 initialPosition, finalPosition, direction;
    private Vector2[] travel;
    private int step = 1;
    
    public ObstaclePiston(World world, OrthographicCamera camera, MapObject rectangleObject1, MapObject rectangleObject2) {
        super(world, camera, rectangleObject1);
        
        //Delay before activation
        if(rectangleObject1.getProperties().get("Delay") != null){
            delay = Float.parseFloat((String) rectangleObject1.getProperties().get("Delay"));
        }
        else if(rectangleObject2.getProperties().get("Delay") != null){
            delay = Float.parseFloat((String) rectangleObject2.getProperties().get("Delay"));
        }
        
        //Motion speed
        if(rectangleObject1.getProperties().get("Speed") != null){
            speed = Float.parseFloat((String) rectangleObject1.getProperties().get("Speed"));
        }
        else if(rectangleObject2.getProperties().get("Speed") != null){
            speed = Float.parseFloat((String) rectangleObject2.getProperties().get("Speed"));
        }
        
        //Creation of the second Fixture
        Rectangle rectangle2 = ((RectangleMapObject) rectangleObject2).getRectangle();
        
        width2 = (rectangle2.width/2) * GameConstants.MPP;
        height2 = (rectangle2.height/2) * GameConstants.MPP;
        posX2 = (rectangle2.x + rectangle2.width/2) * GameConstants.MPP;
        posY2 = (rectangle2.y + rectangle2.height/2) * GameConstants.MPP;
        
        shape2 = new PolygonShape();
        shape2.setAsBox(width2, height2, new Vector2(posX2 - posX, posY2 - posY), 0);
        
        bodyDef.position.set(new Vector2((rectangle2.x + rectangle2.width/2) * GameConstants.MPP, (rectangle2.y + rectangle2.height/2) * GameConstants.MPP));
        
        fixtureDef = new FixtureDef();
        fixtureDef.shape = shape2;
        fixtureDef.density = 0;  
        fixtureDef.friction = 0.5f;  
        fixtureDef.restitution = 0.5f;
        
        body.createFixture(fixtureDef);  
        body.setUserData("ObstaclePiston");        
        shape2.dispose();

        if(rectangleObject1.getProperties().get("Part").equals("Head")){
            body.getFixtureList().get(0).setUserData("ObstaclePiston");
            body.getFixtureList().get(1).setUserData("Obstacle");
            
            //initialPosition = body.getPosition();
            initialPosition = new Vector2(posX, posY);
            if(posX == posX2)
                finalPosition = new Vector2(initialPosition.x, initialPosition.y + rectangle2.height * Math.signum(posY2 - posY) * GameConstants.MPP);
            else
                finalPosition = new Vector2(initialPosition.x + rectangle2.width * Math.signum(posX2 - posX) * GameConstants.MPP, initialPosition.y);
        }
        else {
            body.getFixtureList().get(0).setUserData("Obstacle");
            body.getFixtureList().get(1).setUserData("ObstaclePiston");

            //initialPosition = body.getPosition();
            initialPosition = new Vector2(posX, posY);
            if(posX == posX2)
                finalPosition = new Vector2(initialPosition.x, initialPosition.y + rectangle.height * Math.signum(posY - posY2) * GameConstants.MPP);
            else
                finalPosition = new Vector2(initialPosition.x + rectangle.width * Math.signum(posX - posX2) * GameConstants.MPP, initialPosition.y);
        }

        travel = new Vector2[2];
        travel[0] = initialPosition;
        travel[1] = finalPosition;

        direction = new Vector2();
        direction = new Vector2(travel[step].x - body.getPosition().x, travel[step].y - body.getPosition().y);
    }
    
    @Override
    public BodyType getBodyType(){
        return BodyType.KinematicBody;
    }

    @Override
    public void active(){
        if(delay &gt; 0){
            delay -= Gdx.graphics.getDeltaTime();
        }
        else{
            if(!new Vector2(travel[step].x - body.getPosition().x, travel[step].y - body.getPosition().y).hasSameDirection(direction)){            
                if(step &gt; 0)
                    step = 0;
                else step = 1;
                
                direction = new Vector2(travel[step].x - body.getPosition().x, travel[step].y - body.getPosition().y);
            }
            body.setLinearVelocity(direction.clamp(speed, speed)); 
        }
    }
}<br></pre><p>About this code :</p><ul><li> ObstaclePiston is a subclass of Obstacle</li><li>After <em>super(world, camera, rectangleObject1);</em>
 , you can see a bunch of code lines to read the different properties of
 the piston to determine if there is a delay before the ObstaclePiston<span> starts moving and the speed of the motion. </span></li><li>Then we create the second <em>Fixture</em>. Notice that the second Fixture is included in the Body (<em>body.createFixture(fixtureDef);</em>), thus there is only one Body.</li><li>Then
 there is another bunch of code lines that I am too lazy to detail. It 
allows to determine which Fixture is the Head and which Fixture is the 
Axis,  and deduce from their positions what will be the direction of the
 ObstaclePiston<span> motion.</span></li><li>Finally, the <em>active()</em> method applies the eventual delay before starting the motion and update the motion direction each time the ObstaclePiston<span> reaches the end of its stroke.</span></li></ul></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6797}" id="post-6797" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-23 00:25:35" class="post_date"><a href="https://itch.io/post/6797">2 years ago</a></span> <span class="edit_message">(Edited 4 times)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Animated Obstacles : Piston (2/2)</h1><p><strong>Making the TiledMapReader recognize the ObstaclePiston</strong></p><p>Here is the updated code for <strong>TiledMapReader</strong> <strong>.java</strong> :</p><pre>private OrthographicCamera camera;
    private World world;
    private MapObjects objects;
    public Array&lt;Obstacle&gt; obstacles;
    private Array&lt;MapObject&gt; pistons;
    public Hero hero;
    
    public TiledMapReader(final MyGdxGame game, TiledMap tiledMap, World world, OrthographicCamera camera){
        this.camera = camera;
        this.world = world;
        
        hero = new Hero(world, camera, tiledMap);
        
        objects = tiledMap.getLayers().get("Objects").getObjects();


        obstacles = new Array&lt;Obstacle&gt;();    
        pistons = new Array&lt;MapObject&gt;();
        
        for (RectangleMapObject rectangleObject : objects.getByType(RectangleMapObject.class)) {
            if(rectangleObject.getProperties().get("Type") != null){
                //End of the level
                if(rectangleObject.getProperties().get("Type").equals("Exit")){
                    Exit finish = new Exit(world, camera, rectangleObject);
                    obstacles.add(finish);
                }
                //Light obstacles
                else if(rectangleObject.getProperties().get("Type").equals("Light")){
                    ObstacleLight obstacle = new ObstacleLight(world, camera, rectangleObject);
                    obstacles.add(obstacle);
                }
                //Pistons
                else if(rectangleObject.getProperties().get("Type").equals("Piston")){
                    pistons.add(rectangleObject);
                }
            }
            else{
                Obstacle obstacle = new Obstacle(world, camera, rectangleObject);
                obstacles.add(obstacle);
            }
        }
        
        //Pistons creation
        for(int i = pistons.size - 1; i &gt; -1; i--){
            if(pistons.get(i).getProperties().get("Group") != null){
                for(int j = 0; j &lt; pistons.size; j++){
                    if(Integer.parseInt(pistons.get(i).getProperties().get("Group").toString()) == Integer.parseInt(pistons.get(j).getProperties().get("Group").toString()) &amp;&amp;
                            i != j){                  
                        ObstaclePiston piston = new ObstaclePiston(world, camera, pistons.get(i), pistons.get(j));
                        obstacles.add(piston);
                        
                        pistons.removeIndex(i);
                        pistons.removeIndex(j);
                        i--;
                    }
                }
            }    
            else
                System.out.println("Piston creation failed");
        }
    }
</pre>Differences with the previous <strong>TiledMapReader.java</strong> :<ul><li>First, we create an Array : <em>pistons = new Array&lt;MapObject&gt; </em></li><li>In the <em>for</em> loop, we store every <em>Rectangles</em> which "Type" is <em>Piston</em> in the <em>pistons</em> Array.</li><li>Outside the main <em>for</em> loop, we create another <em>for</em> loop dedicated to create <em>ObstaclePiston</em> : It will check if 2 objects in the <em>pistons</em> Array have the same "Group" number, create an <em>ObstaclePiston</em> from these 2 objects before removing them from the <em>pistons</em> Array and adding the newly create ObstaclePiston to the <em>obstacles</em> Array.</li></ul><p><strong>Finally, we need to run the active() method in the GameScreen</strong></p><p>In the <em>render()</em> of the <em>GameScree.java</em>, we only need to add this lines :</p><pre>for(Obstacle obstacle : mapReader.obstacles){
            obstacle.active();
}
</pre><p>Here is a gif of the result :</p><p><img src="blog_fichiers/26tP3sZE7xPcItEQM.gif"><span></span></p><p><strong>Now that we have these ObstaclePiston, we need to create the losing condition "Hero gets crushed" !</strong></p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6810}" id="post-6810" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-23 04:31:03" class="post_date"><a href="https://itch.io/post/6810">2 years ago</a></span> <span class="edit_message">(Edited 2 times)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Losing condition : Major Tom gets crushed !</h1><p>OK now we have these nice pistons, Major Tom can get crushed by them, making the player lose the game.</p><p>Detecting the event "Tom gets crushed" happens in the <em>ContactListener</em> we set in the <em>GameScreen</em>, to detect collisions between bodies.</p><p>Remember, the ContactListener has 4 methods :</p><ol><li>beginContact</li><li>endContact</li><li>preSolve</li><li>postSolve</li></ol><p>The
 one that interests us here is the postSolve method. The postSolve 
method gives us access to the impulse that a body undergoes after a 
collision. The idea is that the more the hero is crushed, the higher the
 impulse he undergoes. Thus, if the impulse exceeds a predetermined 
value, the hero dies.</p><p>Here is the code of the <strong>postSolve</strong> method of the <strong>ContactListener</strong> in the <strong>GameScreen.java</strong> :</p><pre>public void postSolve(Contact contact, ContactImpulse impulse) {
                Body bodyA = contact.getFixtureA().getBody();
                Body bodyB = contact.getFixtureB().getBody();
                
                //Hero death by crushing
                if(bodyA.getUserData().equals("Tom") || bodyB.getUserData().equals("Tom")){ 
                    for(int i = 0; i &lt; impulse.getNormalImpulses().length; i++){
                        if(impulse.getNormalImpulses()[i] &gt; GameConstants.CRUSH_IMPULSE){
                            System.out.println("Oh noes ! Major Tom has been crushed !!");
                        }
                    }
                }
            }
</pre><p>About this code :</p><ul><li>First we check if Major Tom is involved in the collision that has been detected</li><li>The
 we check if one of the impulses exceeds the max value we put in the 
GameConstants.java. One of the impulses ? Yes, when you have a collision
 between two bodies, each of the bodies undergoes an impulse, therefore,
 for one collision, two impulses.</li><li>If one of the impulse exceeds the threshold, we print a message in the console.</li></ul><div>Don't foget to add this line in the <strong></strong><strong>GameConstants.java</strong> :</div><pre>public static float CRUSH_IMPULSE = 300;
</pre><p>The value of 300 is completely arbitrary. I'll probably change it when the time of fine tuning comes.</p><p><br></p><p>And here is the  result ! Simple, isn‚Äôt it ?</p><p><img src="blog_fichiers/26tOXXfYV5GDomVlm.gif"><br></p><p><strong>Notice :</strong> The code I put in the <em>postSolve</em>
 will also detect any collision that produces an impulse that exceeds 
the threshold, for example if the hero flies at very high speed and hit a
 wall. I could make a condition that the hero dies only if he is crushed
 by a piston, but I like the idea that he could die by a high-speed 
collision, that would add challenge to the game. So for now, I stick 
with that code.</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6814}" id="post-6814" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-23 05:31:01" class="post_date"><a href="https://itch.io/post/6814">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Animated Obstacle : Moving Obstacle</h1>Always with the view of having more level designing possibility and a richer gameplay, we'll create another kind of <em>Obstacle</em> : The <em>ObstacleMoving</em>.<p>The
 ObstacleMoving is an obstacle that will follow a given path. You only 
have to draw the path in Tiled, and the code will generate an Obstacle 
that will follow this path, back and forth, or in a loop according to 
the properties you give it.</p><p>To draw the path, we'll use the polyline tool of Tiled :</p><p><img src="blog_fichiers/584643Image1.png"> <br></p><p>And here is an animation showing how easy it is to create an <em>ObstacleMoving</em>... once you typed all the code, haha.</p><p><img src="blog_fichiers/26tPjxWjqbs2c1Wxy.gif"> <br></p><p><strong>Modifying the Obstacle.java</strong></p><p>First, obviously, this <em>ObstacleMoving</em> requires a <em>PolylineMapObject</em> instead of a <em>RectangleMapObject</em>, thus we can't use the Obstacle.java as is. We need to add a creator that takes into account the <em>PolylineMapObject</em>.</p><p>Here is the new creator in <strong></strong><strong>Obstacle.java</strong> :</p><pre>public Obstacle(World world, OrthographicCamera camera, PolylineMapObject polylineObject){
        
    }<br></pre><p>Yes, this creator is empty. It's only here in order to be able to create a subclass, <strong>ObstacleMoving.java</strong>, that uses a <em>PolylineMapObject</em>.</p><p>And here is the code of the <strong>ObstacleMoving.java</strong> :</p><pre>public class ObstacleMoving extends Obstacle{

    private float speed;
    private boolean backward, loop;
    private Vector2 direction;
    private Vector2[] path;
    private int step;
    
    public ObstacleMoving(World world, OrthographicCamera camera, PolylineMapObject polylineObject) {
        super(world, camera, polylineObject);
        
        //SPEED
        if(polylineObject.getProperties().get("Speed") != null)
            speed = Float.parseFloat((String) polylineObject.getProperties().get("Speed"));
        else speed = 5;
        
        //DOES THE PATH MAKE A LOOP ?
        if(polylineObject.getProperties().get("Loop") != null)
            loop = true;
        else loop = false;
        
        //WIDTH OF THE MOVING OBJECT
        if(polylineObject.getProperties().get("Width") != null)
            width = Integer.parseInt((String) polylineObject.getProperties().get("Width")) * GameConstants.PPT * GameConstants.MPP/2;
        else
            width = 2 * GameConstants.PPT * GameConstants.MPP/2;
        
        //HEIGHT OF THE MOVING OBJECT
        if(polylineObject.getProperties().get("Height") != null)
            height = Integer.parseInt((String) polylineObject.getProperties().get("Height")) * GameConstants.PPT * GameConstants.MPP/2;
        else
            height = 2 * GameConstants.PPT * GameConstants.MPP/2;
        
        path = new Vector2[polylineObject.getPolyline().getTransformedVertices().length/2];
        for(int i = 0; i &lt; path.length; i++){
            path[i] = new Vector2(polylineObject.getPolyline().getTransformedVertices()[i*2]*GameConstants.MPP, polylineObject.getPolyline().getTransformedVertices()[i*2 + 1]*GameConstants.MPP);
        }   
        
        polygonShape = new PolygonShape();
        polygonShape.setAsBox(width, height);

        bodyDef = new BodyDef();
        bodyDef.type = getBodyType();
        bodyDef.position.set(path[0]);
        
        fixtureDef = new FixtureDef();
        fixtureDef.shape = polygonShape;
        fixtureDef.density = 0.0f;  
        fixtureDef.friction = 0.0f;  
        fixtureDef.restitution = 0f;

        body = world.createBody(bodyDef);
        body.createFixture(fixtureDef).setUserData("Objet");
        body.setUserData("Objet");
        
        polygonShape.dispose();

        direction = new Vector2(path[step].x - body.getPosition().x, path[step].y - body.getPosition().y);
        body.setLinearVelocity(direction.clamp(speed, speed));
    }
    
    @Override
    public BodyType getBodyType(){
        return BodyType.KinematicBody;
    }

    @Override
    public void active(){
        if(!loop){
            if(!backward){
                if(!new Vector2(path[step].x - body.getPosition().x, path[step].y - body.getPosition().y).hasSameDirection(direction)){
                    step++;
                    
                    if(step == path.length){
                        backward = true;
                        step = path.length - 2;
                    }
                    
                    direction.set(path[step].x - body.getPosition().x, path[step].y - body.getPosition().y);
                }
            }
            else{
                if(!new Vector2(path[step].x - body.getPosition().x, path[step].y - body.getPosition().y).hasSameDirection(direction)){
                    step--;
                    
                    if(step &lt; 0){
                        backward = false;
                        step = 1;
                    }
                    
                    direction.set(path[step].x - body.getPosition().x, path[step].y - body.getPosition().y);
                }
            }    
        }
        else{
            if(!new Vector2(path[step].x - body.getPosition().x, path[step].y - body.getPosition().y).hasSameDirection(direction)){
                step++;
                
                if(step == path.length){
                    step = 0;
                }
                
                direction.set(path[step].x - body.getPosition().x, path[step].y - body.getPosition().y);
            }
        }
        body.setLinearVelocity(direction.clamp(speed, speed)); 
    }
}<br></pre><p>About this code :</p><ul><li> First we check the properties of the <em>PolylineMapObject</em> to determine the speed, the dimension and the behavior of the <em>ObstacleMoving</em>.</li><li>Then we put the coordinate of every points in an Array, which will form the path that the <em>Obstacle</em> will follow</li><li>Then we create the body of the <em>Obstacle</em>.</li><li>And we give a direction and an impulse to initiate the motion.</li><li>Finally, it the <em>active()</em> method, we check if the Obstacle is between 2 points of the <em>path </em>Array, and we update the direction every time the <em>Obstacle</em> is not between 2 points.</li></ul><div>This ObstacleMoving gives us opportunities to create some cool design :</div><p><img src="blog_fichiers/3o8doTUy3SbwGmui8o.gif"><span></span></p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6930}" id="post-6930" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-24 04:43:49" class="post_date"><a href="https://itch.io/post/6930">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Simulating a gas leak</h1><p>Here
 is the situation : Major Tom‚Äôs spaceship is completely wrecked because 
it entered a very dense region of the asteroid belt, thus it was hit by 
uncountable micrometeoroids. In some places, tubes carrying oxygen a 
various gases were punctured, causing gas leak.</p><p>In the absence of gravity, these gas leaks will propel anything that crosses the gas spray.</p><p>Here is an animation showing what happens when Major Tom pushes floating boxes in a gas leak :</p><p><img src="blog_fichiers/26tPkYmVH251tpj6o.gif"> <br></p><p>Let's see the code of <strong>Leak.java</strong> :</p><pre>public class Leak extends Obstacle{

    private Set&lt;Fixture&gt; fixtures;
    private Vector2 leakForce, leakOrigin;
    private float force, leakSize;
    
    public Leak(World world, OrthographicCamera camera,    MapObject rectangleObject) {
        super(world, camera, rectangleObject);
        
        body.getFixtureList().get(0).setSensor(true);
        body.getFixtureList().get(0).setUserData("Leak");
        body.setUserData("Leak");
        
        fixtures = new HashSet&lt;Fixture&gt;();
        
        //Leak force
        if(rectangleObject.getProperties().get("Force") != null){
            force = Float.parseFloat(rectangleObject.getProperties().get("Force").toString()) * GameConstants.DEFAULT_LEAK_FORCE;
        }
        else
            force = GameConstants.DEFAULT_LEAK_FORCE;
        
        //Leak direction and leak origine
        if(rectangle.width &gt; rectangle.height){
            leakForce = new Vector2(force, 0);
            leakSize = rectangle.width * GameConstants.MPP;
            
            if(force &gt; 0)
                leakOrigin = new Vector2(posX - width, posY);
            else
                leakOrigin = new Vector2(posX + width, posY);
        }
        else{
            leakForce = new Vector2(0, force);
            leakSize = rectangle.height * GameConstants.MPP;
            
            if(force &gt; 0)
                leakOrigin = new Vector2(posX, posY - height);
            else
                leakOrigin = new Vector2(posX, posY + height);
        }
    }
    
    public void addBody(Fixture fixture) {
        PolygonShape polygon = (PolygonShape) fixture.getShape();
        if (polygon.getVertexCount() &gt; 2) 
            fixtures.add(fixture);
    }

    public void removeBody(Fixture fixture) {
        fixtures.remove(fixture);
    }
    
    public void active(){
        for(Fixture fixture : fixtures){
            float distanceX = Math.abs(fixture.getBody().getPosition().x - leakOrigin.x);
            float distanceY = Math.abs(fixture.getBody().getPosition().y - leakOrigin.y);
            
            fixture.getBody().applyForceToCenter(    
                                                    leakForce.x * Math.abs(leakSize - distanceX)/leakSize, 
                                                    leakForce.y * Math.abs(leakSize - distanceY)/leakSize,
                                                    true
                                                );
        }
    }
}<br></pre><p>About this code :</p><ul><li> Leak extends Obstacle</li><li>Leak is a sensor, so there are no physical collisions with a leak. But it still detects collisions.</li><li>Then we set up an HashSet called fixtures, where we‚Äôll gather and manage all the fixtures that enter and exit gas spray.</li><li>We then read the properties of the rectangle we drew in Tiled to get the speed.</li><li>The following bunch of code lines automatically deduct the position of the leak origin and the direction of the gas spray.</li><li>Then we have <em>addBody()</em> and <em>removeBody()</em> functions that will be called in the GameScreen each time a body enters or exits the gas spray.</li><li>Finally, in the <em>active()</em>
 function we apply a force to all the bodies that are in the gas spray. 
Note that the force decreases as you are farther from the leak origin.</li></ul><div>The <strong>TiledMapReader.java</strong>
 needs to recognize the leak. No surprises for that, it‚Äôs always the 
same thing, you only need to add few code lines in the main <em>for</em> loop :</div><pre>for (RectangleMapObject rectangleObject : objects.getByType(RectangleMapObject.class)) {
            if(rectangleObject.getProperties().get("Type") != null){
<span>                ...
</span>
                //Leaks
                else if(rectangleObject.getProperties().get("Type").equals("Leak")){
                    Leak leak = new Leak(world, camera, rectangleObject);
                    obstacles.add(leak);
                }

                ...
            }
}</pre><p>In the <strong>GameScreen.java</strong>, we'll use <em>beginContact</em> and <em>enContact</em> functions of the <em>ContactListener</em> to add or remove bodies from the gas spray :</p><pre>public void beginContact(Contact contact) {
                Fixture fixtureA = contact.getFixtureA();
                Fixture fixtureB = contact.getFixtureB();
                
                if(fixtureA.getUserData() != null &amp;&amp; fixtureB.getUserData() != null) {
                    //Leak
                    if (fixtureA.getUserData().equals("Leak") &amp;&amp; fixtureB.getBody().getType() == BodyType.DynamicBody) {
                        for(Obstacle obstacle : mapReader.obstacles){
                            if(obstacle.body.getFixtureList().get(0) == fixtureA){
                                Leak leak = (Leak) obstacle;
                                leak.addBody(fixtureB);
                            }
                        }
                    } 
                    else if (fixtureB.getUserData().equals("Leak") &amp;&amp; fixtureA.getBody().getType() == BodyType.DynamicBody) {
                        for(Obstacle obstacle : mapReader.obstacles){
                            if(obstacle.body.getFixtureList().get(0) == fixtureB){
                                Leak leak = (Leak) obstacle;
                                leak.addBody(fixtureA);
                            }
                        }
                    }                 
                }          
            }


            @Override
            public void endContact(Contact contact) {
                Fixture fixtureA = contact.getFixtureA();
                Fixture fixtureB = contact.getFixtureB();
                
                if(fixtureA.getUserData() != null &amp;&amp; fixtureB.getUserData() != null) {
                    //Leak
                    if (fixtureA.getUserData().equals("Leak") &amp;&amp; fixtureB.getBody().getType() == BodyType.DynamicBody) {
                        for(Obstacle obstacle : mapReader.obstacles){
                            if(obstacle.body.getFixtureList().get(0) == fixtureA){
                                Leak leak = (Leak) obstacle;
                                leak.removeBody(fixtureB);
                            }
                        }
                    } 
                    else if (fixtureB.getUserData().equals("Leak") &amp;&amp; fixtureA.getBody().getType() == BodyType.DynamicBody) {
                        for(Obstacle obstacle : mapReader.obstacles){
                            if(obstacle.body.getFixtureList().get(0) == fixtureB){
                                Leak leak = (Leak) obstacle;
                                leak.removeBody(fixtureA);
                            }
                        }
                    }
                }
            }<br></pre><p>And that's it ! Another feature for the level design !</p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6936}" id="post-6936" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-24 06:01:37" class="post_date"><a href="https://itch.io/post/6936">2 years ago</a></span> <span class="edit_message">(Edited 3 times)</span> <span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Interacting with the environment : Switches</h1><p>OK,
 thus far I have animated obstacles like ObstaclePiston and 
ObstacleMoving, and I plan to have few others. It would be very 
interesting if we could enable/disable these animated obstacles with 
switches. And it would be interesting if one switch could control 
several obstacles at a time, and also if an obstacle could be controlled
 by several switches. It will allow me to create some puzzles.</p><p>Here is a video showing how that works :</p><p><iframe src="blog_fichiers/6F35t4YGdXE.html" allowfullscreen="" width="500" height="281" frameborder="0"></iframe><span></span><br></p><p>As you can see in the video, to associate a switch with one or several animated object, I use an <em>Association Number</em>. For that, as usual, I set a property in <em>Tiled</em>,
 I give it the name "Association Number", and I give the same number to 
the switch and the animated object that I want to control. I can give 
several <em>Association Numbers</em> to the switch, by separating them with a comma, if I want the switch to control several objects.</p><p>Here is the code for <strong>ItemSwitch.java</strong> :</p><pre>public class ItemSwitch {

    public Body swtichBody;
    private BodyDef bodyDef;
    private FixtureDef fixtureDef;
    private PolygonShape switchShape;
    private float width, height;
    private boolean isOn;
    private String[] associationNumbers;
    
    public ItemSwitch(World world,  OrthographicCamera camera, MapObject mapObject){
        create(world, camera, mapObject);
    }
    
    public void create(World world,  OrthographicCamera camera, MapObject mapObject){      
        //Is the switch on ?
        if(mapObject.getProperties().get("On") != null){
            if(Integer.parseInt((String) mapObject.getProperties().get("On")) == 1)
                isOn = true;
            else 
                isOn = false;
        }
        else
            isOn = false;
        
        //Association Numbers
        if(mapObject.getProperties().get("Association Number") != null){
            associationNumbers = mapObject.getProperties().get("Association Number").toString().split(",");
        }
        
        width = mapObject.getProperties().get("width", float.class)/2 * GameConstants.MPP;
        height = mapObject.getProperties().get("height", float.class)/2 * GameConstants.MPP;
        
        bodyDef = new BodyDef();
        fixtureDef = new FixtureDef();
        
        bodyDef.type = BodyType.StaticBody;

        bodyDef.position.set((mapObject.getProperties().get("x", float.class) + mapObject.getProperties().get("width", float.class)/2) * GameConstants.MPP,
                            (mapObject.getProperties().get("y", float.class) + mapObject.getProperties().get("height", float.class)) * GameConstants.MPP);
        
        switchShape = new PolygonShape();
        switchShape.setAsBox(width, height);
        
        fixtureDef.shape = switchShape;
        fixtureDef.density = 0;  
        fixtureDef.friction = 0.2f;  
        fixtureDef.restitution = 0f;
        fixtureDef.isSensor = true;
        
        swtichBody = world.createBody(bodyDef);
        swtichBody.createFixture(fixtureDef).setUserData("Switch");
        swtichBody.setUserData("Switch");     
    }
    
    public void active(Array&lt;Obstacle&gt; obstacles){    
        isOn = !isOn;
        
        for(String number : associationNumbers){
            for(Obstacle obstacle : obstacles)
                if(obstacle.associationNumber == Integer.valueOf(number))
                    obstacle.activate();
        }
    }
}
</pre><p>About this code :</p><ul><li>First, I read the properties of the <em>TiledMapObject</em> to see if the switch is <em>on</em> or <em>off</em> by default.</li><li>Then I read the properties to obtain all the <em>Association Numbers</em> of the switch. For that I set up a String array.</li><li>Then I create the body of the switch, that is a sensor.</li><li>Finally, I create the <em>active()</em> function that will be called if there is a contact between Major Tom and the switch. The <em>active()</em><span> function will check for evey <em>Association Number</em><span> stored in the String Array if one of the Obstacle in the map posses the same <em>Association Number</em><span>. If yes, the function modifies the Obstacle's <em>activate()</em> function.<br></span></span></span></li></ul><p><strong>To use the <em>ItemSwitch</em>, with the <em>Obstacle</em>s, I need to do some modifications in Obstacle.java:</strong></p><ul><li>Add an int <em>associationNumber</em><em></em></li><li>Add a boolean <em>active</em><span><em></em></span></li><li><span>Add a function <em>activate()</em><span></span></span></li></ul><p>The <em>activate()</em> function will be defined in each type of Obstacle. For now it the same function for both <em>ObstaclePiston</em> and <em>ObstacleMoving</em> :</p><pre>public void activate(){
        active = !active;
    }</pre>And of course, the <em>active()</em> function of every type 
of Obstacle must take into account the new boolean active (I guess it 
starts to be really confusing between <em>active</em>, <em>active()</em> and <em>activate()</em>) So basicaly, the new active() of every Obstacle looks like this :<pre>public void active(){
        if(active){
           //Do the regular stuff
        }
        else
            body.setLinearVelocity(0, 0);         
    }</pre><p><strong>Finally, we need to detect collision between Major Tom and ItemSwitch</strong></p><pre>public void beginContact(Contact contact) {
                Fixture fixtureA = contact.getFixtureA();
                Fixture fixtureB = contact.getFixtureB();
                
                if(fixtureA.getUserData() != null &amp;&amp; fixtureB.getUserData() != null) {       
                    //Switch
                    if(fixtureA.getUserData().equals("Tom") &amp;&amp; fixtureB.getUserData().equals("Switch")){
                        for(ItemSwitch itemSwitch : mapReader.switchs){
                            if(itemSwitch.swtichBody == fixtureB.getBody())
                                itemSwitch.active(mapReader.obstacles);
                        }
                    }
                    else if(fixtureB.getUserData().equals("Tom") &amp;&amp; fixtureA.getUserData().equals("Switch")){
                        for(ItemSwitch itemSwitch : mapReader.switchs){
                            if(itemSwitch.swtichBody == fixtureA.getBody())
                                itemSwitch.active(mapReader.obstacles);
                        }
                    }
                }
            }
</pre><p>And that's it ! Here is the result :</p><p><img src="blog_fichiers/26tP3X2THpOizMHss.gif"><span></span><br></p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6937}" id="post-6937" class="community_post sidebar_avatar"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-24 06:16:58" class="post_date"><a href="https://itch.io/post/6937">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>Now we have switches, let's create doors !</h1><p>Now that I can control objects with switches, I can create doors, that can be open/closed with switches.</p><p>Here is the code of <strong></strong><strong>ObstacleDoor.java</strong> :</p><pre>public class ObstacleDoor extends Obstacle{
    
    private float speed = 5;
    private Vector2 initialPosition, finalPosition;

    public ObstacleDoor(World world, OrthographicCamera camera,    MapObject rectangleObject) {
        super(world, camera, rectangleObject);
        
        //Motion speed
        if(rectangleObject.getProperties().get("Speed") != null){
            speed = Float.parseFloat((String) rectangleObject.getProperties().get("Speed"));
        }
        
        initialPosition = new Vector2(posX, posY);
        
        if(width &gt; height)
            finalPosition = new Vector2(posX + Math.signum(speed) * 1.9f*width, posY);
        else
            finalPosition = new Vector2(posX, posY + Math.signum(speed) * 1.9f*height);
    }
    
    @Override
    public BodyType getBodyType(){
        return BodyType.KinematicBody;
    }
    
    @Override
    public void active(){
        if(active)
            body.setLinearVelocity(    Math.signum(speed) * (initialPosition.x - body.getPosition().x) * speed, 
                                    Math.signum(speed) * (initialPosition.y - body.getPosition().y) * speed
                                    );
        else
            body.setLinearVelocity(    Math.signum(speed) * (finalPosition.x - body.getPosition().x) * speed,
                                    Math.signum(speed) * (finalPosition.y - body.getPosition().y) * speed
                                    );
    }
<span>
    </span>@Override
    public void activate(){
        active = !active;
    }
}<br></pre><p>About this code :</p><ul><li> <em>ObstacleDoor</em> is a subclass of <em>Obstacle</em>.</li><li>First I read check in the Properties of the TiledMapObject for the opening speed value.</li><li>Then I set the closed and open positions of the door.</li><li>Finally, the <em> active()</em> function move the door to the open/closed position according to the value of the boolean <em>active</em>.</li></ul><div>The following is straightforward, if you followed this devlog :</div><p>The <strong>TiledMapReader.java</strong> need to recognize the <em>ObstacleDoor</em> in the map :</p><pre>for (RectangleMapObject rectangleObject : objects.getByType(RectangleMapObject.class)) {
            if(rectangleObject.getProperties().get("Type") != null){
                ...

                //Doors
                else if(rectangleObject.getProperties().get("Type").equals("Door")){
                    ObstacleDoor obstacle = new ObstacleDoor(world, camera, rectangleObject);
                    obstacles.add(obstacle);
                }

                ...
            }
        }<br></pre><p>And here is the result !</p><p><img src="blog_fichiers/26tP6cwTPw6oMtDEs.gif"><span></span><br></p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><div id="last-post"></div><div data-post="{&quot;user_id&quot;:101831,&quot;id&quot;:6944}" id="post-6944" class="community_post sidebar_avatar last_root_post"><div class="post_votes"><a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_up_btn vote_btn icon-caret-up"></a> <a data-register_action="community_vote" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="vote_down_btn vote_btn icon-caret-down"></a></div><div class="post_content"><div class="post_header"><a href="https://itch.io/profile/apprenticesoft" class="avatar_container"><div style="background-image: url(https://img.itch.zone/aW1hZ2UyL3VzZXIvMTAxODMxLzI3OTM4MS5qcGc=/80x80%23/lB24rc.jpg)" class="post_avatar"></div></a><div class="post_header_content"><span class="post_author"><a href="https://itch.io/profile/apprenticesoft">Apprentice Soft</a></span><span title="2015-12-24 07:48:14" class="post_date"><a href="https://itch.io/post/6944">2 years ago</a></span><span class="vote_counts"></span></div></div><div class="post_body user_formatted"><h1>One last animated obstacle : Revolving Obstacle !</h1><div>OK,
 here is probably the last Obstacle I‚Äôll create. After that, I think I 
have enough to design cool levels. Revolving Obstacles... revolves... 
yeah I know, kinda obvious.</div><p>So here is the (short and easy) code for this <strong>ObstacleRevolving.java</strong> :</p><pre>public class ObstacleRevolving extends Obstacle{
    
    private float speed = 90;

    public ObstacleRevolving(World world, OrthographicCamera camera, MapObject rectangleObject) {
        super(world, camera, rectangleObject);
        
        //Rotation speed
        if(rectangleObject.getProperties().get("Speed") != null)
            speed = Float.parseFloat((String) rectangleObject.getProperties().get("Speed"));
        
        body.setFixedRotation(false);
        body.setAngularVelocity(speed*MathUtils.degreesToRadians);
    }
    
    @Override
    public BodyType getBodyType(){
        return BodyType.KinematicBody;
    }
    
    @Override
    public void activate(){
        active = !active;
        
        if(active)
            body.setAngularVelocity(speed*MathUtils.degreesToRadians);
        else
            body.setAngularVelocity(0);
    }
}<br></pre><p>About this code :</p><ul><li> <em> ObstacleRevolving</em> extends <em>Obstacle</em></li><li><em>ObstacleRevolving</em><span> <span>is formed by a KinematicBody</span><br></span></li><li>I read the properties of the <em>TiledMapObject</em><span> to determine the rotation speed...</span></li><li><span>... and I apply the angular velocity</span></li><li><span>Finally, the <em></em><em>activate()</em> function called when we use an <em>ItemSwitch</em> to control the <em>ObstacleRevolving</em><span> sets the angular velocity to 0 or to the speed value, depending on if we turn the <em>ObstacleRevolving</em> <em>on</em> or <em>off</em>.</span></span></li></ul><div>And guess what code we put in the main <em>for</em> loop of the <strong>TiledMapReader.java</strong> ? Yeah, you‚Äôre right :</div><pre>for (RectangleMapObject rectangleObject : objects.getByType(RectangleMapObject.class)) {
            if(rectangleObject.getProperties().get("Type") != null){
                ...

                //Revolving obstacles
                else if(rectangleObject.getProperties().get("Type").equals("Revolving")){
                    ObstacleRevolving obstacle = new ObstacleRevolving(world, camera, rectangleObject);
                    obstacles.add(obstacle);
                }

                ...
            }<br></pre>And here is the result !<p><img src="blog_fichiers/d2Zlbeq8Kj8Nx60w.gif"> </p></div><div class="post_footer"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="post_action reply_btn">Reply</a></div></div></div><script id="vote_counts_tpl" type="text/template"><% if (up_score > 0) { %><span class="upvotes">(+{{up_score}})</span><% } %><% if (down_score > 0) { %><span class="downvotes">(-{{down_score}})</span><% } %></script></div></div><div class="topic_pager bottom_pager"><span class="page_label">Viewing posts <nobr><span>1</span> to <span>20</span> of 43</nobr></span> ¬∑ <a href="https://itch.io/jam/libgdxjam/topic/12039/apprentice-softs-devlog?after=20" class="page_link">Next page</a> ¬∑ <a href="https://itch.io/jam/libgdxjam/topic/12039/apprentice-softs-devlog?before=44" class="page_link">Last page</a></div><div class="topic_posts_footer"><div class="create_account_banner"><a data-register_action="community_reply" href="https://itch.io/login?return_to=https%3A%2F%2Fitch.io%2Fjam%2Flibgdxjam%2Ftopic%2F12039%2Fapprentice-softs-devlog&amp;intent=community" class="button">Log in to reply</a>Join the discussion. Log in or create a free itch.io account to continue. </div></div></div><script type="text/javascript">new I.CommunityViewTopic('#community_topic_posts_widget_54451', {"report_url":"\/post\/:post_id\/report"})</script></div></div></div><div class="footer"><div class="primary"><div class="social"><a href="http://twitter.com/itchio"><span class="icon icon-twitter"></span></a><a href="http://facebook.com/itchiogames"><span class="icon icon-facebook"></span></a></div><a href="https://itch.io/docs/general/about">about</a><a href="https://itch.io/docs/general/faq">faq</a><a href="https://itch.io/docs/general/team">team</a><a href="http://blog.itch.io/">blog</a><a href="https://itch.io/support">contact us</a></div><div class="secondary">Copyright ¬© 2018 itch corp<span class="spacer">¬∑</span><a href="https://itch.io/directory">Directory</a><span class="spacer">¬∑</span><a rel="nofollow" href="https://itch.io/docs/legal/terms">Terms of Service</a><span class="spacer">¬∑</span><a rel="nofollow" href="https://itch.io/docs/legal/privacy-policy">Privacy policy</a></div></div><script id="loading_lightbox_tpl" type="text/template"><div class="lightbox loading_lightbox"><div class="loader_outer"><div class="loader_label">Loading</div><div class="loader_bar"><div class="loader_bar_slider"></div></div></div></div></script><script type="text/javascript">I.setup_page();</script></body></html>